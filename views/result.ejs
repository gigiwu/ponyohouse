<!-- views/result.ejs -->

<!DOCTYPE html>
<html lang="en">
<head><% include ./partials/head %></head>
<body class="container">
    <header><% include ./partials/header %></header>
    <main>
      <div>
        <% include ./partials/searchpanel %>
        <p><%= query %> の物件は <%= count %> 件あります。</p>
      </div>

      <div>
        <% for (let i = 0; i < results.length; i++) { %>
          <% const result = results[i] %>
          <% if (result.title == "") { continue; } %>
          <div class="result-board">
            <a rel="nofollow" href="<%= result.URL %>" target="_blank">
              <p class="text-primary"><%= result.title %></p>
            </a>
            <p class="text-success"><%= result.url %></p>
            <p class="result-address"><%= result.address %></p>
            <p class="result-text"><%= result.description %></p>
          </div>
        <% } %>
      </div>

      <div class="paging">
        <nav aria-label="Page navigation">
          <ul class="pagination">
            <% if (parseInt(page) > 0) { %>
              <li class="page-item">
                <a class="page-link" href="?query=<%= query %>&page=<%= parseInt(page) - 1 %>" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
            <% } %>
            <% const start_page = Math.max(parseInt(page) - 5, 0); %>
            <% for (let p = start_page; p < start_page + 10; p++) { %>
              <% const active = (page == p) ? " active" : ""; %>
              <li class="page-item<%= active %>"><a class="page-link" href="?query=<%= query %>&page=<%= p %>"><%= parseInt(p) + 1 %></a></li>
            <% } %>
            <li class="page-item">
              <a class="page-link" href="?query=<%= query %>&page=<%= parseInt(page) + 1 %>" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </main>
    <footer>
      <% include ./partials/footer %>
    </footer>
  </body>
</html>
